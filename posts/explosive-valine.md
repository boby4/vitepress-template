---
date: 2023-12-20
title: çˆ†æ”¹åšå®¢è¯„è®ºç»„ä»¶Valine
tags:
- ç»„ä»¶
description: çˆ†æ”¹äº†Valineçš„å„ç§é—®é¢˜ï¼Œç„¶ååŠ äº†ä¸€äº›æ ·å¼ä¼˜åŒ–ï¼ŒåŒ…æ‹¬QQå¤´åƒæ˜¾ç¤ºã€è‡ªå®šä¹‰è¡¨æƒ…åŒ…ï¼Œè‡ªå·±æ¥å…¥é‚®ä»¶å‘é€ç­‰é—®é¢˜ï¼Œç¡¬æ˜¯æŠŠä»–ç»™æ•‘æ´»äº†ğŸ¤ª
---

## çˆ†æ”¹åšå®¢è¯„è®ºç»„ä»¶Valine

æ‰¾äº†å¾ˆä¹…çš„åšå®¢è¯„è®ºç»„ä»¶äº†ï¼Œç¢°äº†å¾ˆå¤šå£ï¼Œä¸€å¼€å§‹æˆ‘ç”¨çš„æ˜¯GitHub Appçš„utterancesï¼Œæˆ‘è¿˜ä¸“é—¨å†™äº†ä¸€ç¯‡æ–‡ç« å»è®²è¿™ä¸ªä¸œä¸œï¼Œç®€å•å¥½ç”¨å§æ€»çš„æ¥è¯´ï¼Œä½†æ˜¯é™åˆ¶å¾ˆå¤šï¼Œåªå­˜åœ¨githubé‡Œé¢è¿˜éœ€è¦githubç™»å½•æ‰å¯ä»¥è¯„è®ºï¼Œå°±æƒ³ç€æ¢ä¸ªç»„ä»¶ï¼Œè¯•äº†å¾ˆå¤šä¸ªï¼ŒWalineè¯•è¿‡ï¼Œæåˆ°æœ€åæˆ‘å‘ç°å®ƒå¥½åƒä¸æ”¯æŒviteï¼Œç™½å¿™æ´»äº†ï¼Œarttalkä¹Ÿè¯•äº†éœ€è¦éƒ¨ç½²ä¸€å¥—åç«¯åœ¨æœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯æˆ‘çš„ç½‘ç«™æ˜¯æ‰˜ç®¡çš„ï¼Œå°±æ˜¯ä¸ºäº†çœé’±æ‰è¿™æ ·æï¼Œæ”¾å¼ƒäº†ï¼Œæœ€åé€‰æ‹©äº†Valineï¼Œä¹Ÿæ˜¯æœ‰å¾ˆå¤šå‘ï¼Œè·ŸWalineå·®ä¸å¤ªå¤šï¼ŒåŒæ ·ä½¿ç”¨ LeanCloud å­˜å‚¨è¯„è®ºæ•°æ®å’Œè®¿é—®æ•°æ®ï¼Œä½†æ˜¯LeanCloudåªæœ‰å›½é™…æœæ‰˜ç®¡æœåŠ¡å™¨ï¼Œå›½é™…æœçœ‹äº†ç½‘ä¸Šè¯´æ˜¯ä¸ç»´æŠ¤äº†ï¼Œè¿™ä¸æ˜¯å°´å°¬ï¼Œåæ¥å‘ç°åå—ååŒ—æœåŠ¡å™¨ä¹Ÿèƒ½å‡‘åˆç”¨ï¼Œåªæ˜¯åŸŸåä¸å¤‡æ¡ˆå°±ç»‘å®šä¸äº†ï¼Œå°±å‘ä¸äº†é‚®ä»¶ï¼Œä¼°è®¡å¤§éƒ¨åˆ†åŠŸèƒ½ä¹Ÿä¸ç»´æŠ¤äº†ï¼Œåªå¥½ç”¨ä»–çš„å­˜å‚¨åŠŸèƒ½ï¼Œé‚®ä»¶å‘é€å¦è¾Ÿè¹Šå¾„ï¼Œå’±ä»¬ä¸»æ‰“çš„å°±æ˜¯ä¸€ä¸ªèƒ½ä¸èŠ±é’±å°±å°½é‡ä¸èŠ±é’±ã€‚

## å®ç°æ•ˆæœ

<a data-fancybox="gallery" href="https://i.miji.bid/2023/12/20/38fce9d5f3f46e0be35ac334ac030412.png" data-caption="Valine">
<img v-lazy="'https://i.miji.bid/2023/12/20/38fce9d5f3f46e0be35ac334ac030412.png'"/>
</a>

## å…³äºValine

ä¸€æ¬¾åŸºäºLeanCloudå­˜å‚¨æ•°æ®çš„æ— åç«¯è¯„è®ºç³»ç»Ÿ

### ä½¿ç”¨Valine

å…³äºæ³¨å†ŒLeanCloudè´¦å·å’Œè·å–keyä¹‹ç±»çš„æ“ä½œç›´æ¥å»çœ‹valineçš„å…¥é—¨æ–‡æ¡£å³å¯ https://valine.js.org/quickstart.html
,æˆ‘è¿™é‡Œå¼•å…¥æ˜¯ç›´æ¥æŠŠvalineçš„jsæ–‡ä»¶ç›´æ¥å¼•å…¥åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼Œæœ¬æ–‡åŸºäºvalineæœ€æ–°ç‰ˆæœ¬**1.5.1**,æ–‡æœ¬æˆ‘ä¼šæ”¾å‡ºå®Œæ•´ä»£ç ã€‚


```vue
<template>
  <div class="post_comments">
    <!-- è¯„è®ºåŒºåŸŸå®¹å™¨ -->
    <div class="line">
      <div class="line_name">è¯„è®º</div>
    </div>
    <section class="page-edit">
      <div class="page-edit-read">
        <!-- é˜…è¯»é‡æ˜¾ç¤ºåŒºåŸŸ -->
        <span class="leancloud-visitors" data-flag-title="Your Article Title">
          <em class="post-meta-item-text">é˜…è¯»é‡ï¼š </em>
          <i class="leancloud-visitors-count"></i>
        </span>
      </div>
      <!-- è¯„è®ºæ’ä»¶å®¹å™¨ -->
      <div id="vcomments"></div>
    </section>
  </div>
</template>

<script setup>
import { watch, onMounted, onBeforeUnmount, nextTick } from 'vue'
import { useRoute } from 'vitepress'
import axios from 'axios'
import { remoteImport } from '../../utils/functions'

const route = useRoute()
const initValine = () => {
  // åˆå§‹åŒ– Valine è¯„è®ºæ’ä»¶
  let path = location.origin + location.pathname
  document.getElementsByClassName('leancloud-visitors')[0].id = path
  new Valine({
    el: '#vcomments',
    appId: '', //è¿™é‡Œæ˜¯ä½ çš„LeanCloud appId
    appKey: '',//è¿™é‡Œæ˜¯ä½ çš„LeanCloud appKey
    path: path,// å½“å‰è·¯ç”±åœ°å€
    enableQQ: true, //å±•ç¤ºä½ çš„qqé“¾æ¥å’Œåœ°å€ï¼Œè¯•äº†æ²¡ç”¨
    visitor: true,// å…è®¸è®¿å®¢ï¼Œè¿™é‡Œæˆ‘é‚®ç®±å¿…å¡«äº†ï¼Œå…¶å®å°±æ˜¯ä¸å…è®¸äº†ï¼Œé‚®ç®±åé¢éœ€è¦ç”¨
    recordIP: true,// å…è®¸è®°å½•ip
    requiredFields: ['mail'],// å¿…å¡«å­—æ®µ
    placeholder: 'è¾“å…¥è¯„è®ºå†…å®¹ï¼Œç‚¹å‡»å¤´åƒè·³è½¬ä¼šå¡«å†™çš„åœ°å€ï¼Œè¾“å…¥é‚®ç®±æˆ‘æ‰ä¼šæ”¶åˆ°ä½ çš„è¯„è®ºé‚®ä»¶å“Ÿ',//è‡ªå®šä¹‰è¾“å…¥æ¡†å ä½æ–‡æœ¬
    emojiCDN: '',// è‡ªå®šä¹‰è¡¨æƒ…åŒ…çš„å‰ç¼€åœ°å€
    emojiMaps: {
      // è‡ªå®šä¹‰è¡¨æƒ…åŒ…åœ°å€key: valueæ ¼å¼
    }
  })
}

// ç›‘å¬è·¯ç”±å˜åŒ–ï¼Œæ›´æ–°è¯„è®ºæ’ä»¶
watch(
  () => route.path,
  () => {
    initValine()
  }
)

onMounted(() => {
  // åŠ è½½æœ¬åœ° Valine æ’ä»¶
  remoteImport('/js/valine.js').then(() => {
    initValine()
  })
})
</script>

```

* è¿™é‡Œç›‘å¬äº†è·¯ç”±çš„å˜åŒ–ï¼Œå½“è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°åˆå§‹åŒ– Valine è¯„è®ºæ’ä»¶ã€‚è¿™æ ·å°±å¯ä»¥å®ç°åœ¨ä¸åŒé¡µé¢ä¸‹ä½¿ç”¨åŒä¸€ä¸ªè¯„è®ºæ’ä»¶ã€‚**remoteImport**æ˜¯ä¸€ä¸ªåŠ è½½è„šæœ¬çš„å‡½æ•°

```js
// è¿œç¨‹å¯¼å…¥æ¨¡å—çš„å‡½æ•°
export function remoteImport(url: string) {
  return new Promise((resolve: any) => {
    // è·å–æ–‡æ¡£å¤´éƒ¨å…ƒç´ 
    var head = document.getElementsByTagName("head")[0];
    // åˆ›å»º script å…ƒç´ 
    var script = document.createElement("script");
    // è®¾ç½®è„šæœ¬ç±»å‹å’Œæºåœ°å€
    script.setAttribute("type", "text/javascript");
    script.setAttribute("src", url);
    // å°† script å…ƒç´ æ·»åŠ åˆ°å¤´éƒ¨
    head.appendChild(script);
    // ç›‘å¬è„šæœ¬åŠ è½½å®Œæˆäº‹ä»¶
    script.onload = function () {
      resolve();
    };
  });
}
```

## æ ·å¼ä¼˜åŒ–

åŠ äº†ä¸€ä¸ªä¾§è¾¹çš„åŠ¨æ€èƒŒæ™¯å›¾ï¼Œæäº¤æŒ‰é’®æ ·å¼ã€å¤´éƒ¨é‚®ç®±ã€æ˜µç§°ã€ç½‘å€è¾“å…¥æ¡†æ ·å¼ã€è¯„è®ºå¤´åƒåŠ é¼ æ ‡æ»‘è¿‡æ—‹è½¬ã€è¯„è®ºæ¡†æ ·å¼ã€è¡¨æƒ…åŒ…å¤§å°ç­‰æ ·å¼ä¼˜åŒ–ï¼Œæ ·å¼æ–‡ä»¶å¦‚ä¸‹ï¼š

```scss
#veditor {
  background-image: url(https://pic.imgdb.cn/item/655dd56fc458853aef7b4274.webp);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: right;
  background-color: rgba(255, 255, 255, 0);
  resize: vertical;
}
#vcomments .vheader .vnick {
  width: 29%;
  border: 2px solid #dedede;
  padding-left: 10px;
  padding-right: 10px;
  border-radius: 5px;
}
#vcomments .vheader .vmail {
  width: 29%;
  border: 2px solid #dedede;
  margin-left: 15px;
  padding-left: 10px;
  padding-right: 10px;
  border-radius: 5px;
}
#vcomments .vpanel .vwrap{
  border: 2px solid #f0f0f0;
}
#vcomments .vheader .vlink {
  width: 29%;
  border: 2px solid #dedede;
  margin-left: 15px;
  padding-left: 10px;
  padding-right: 10px;
  border-radius: 5px;
}
img.vimg {
  transition: all 1s; /* æ—‹è½¬æ—¶é—´ä¸º 1s */
}
img.vimg:hover {
  transform: rotate(360deg);
  -webkit-transform: rotate(360deg);
  -moz-transform: rotate(360deg);
  -o-transform: rotate(360deg);
  -ms-transform: rotate(360deg);
}
#vcomments .vcards .vcard {
  margin: 0 2px;
  padding: 15px 20px 0 20px;
  border-radius: 10px;
  margin-bottom: 15px;
  box-shadow: 0 0 3px 1px rgba(0, 0, 0, 0.12);
  transition: all 0.3s;
}
#vcomments .vcards .vcard:hover {
  box-shadow: 0 0 6px 2px rgba(0, 0, 0, 0.12);
}
#vcomments .vcards .vcard .vh .vcard {
  border: none;
  box-shadow: none;
}
#vcomments .vcards .vcard .vh .vhead .vsys{
  background: #828282;
  padding: 0 0.2rem;
  color: #fff;
  font-size: 12px;
  line-height: 20px;
}
#vcomments .vrow .vsubmit{
  color: #555;
  padding: 0.5em 2.3em;
  margin: 0 0.5em;
  min-width: 60px;
  max-width: 100%;
  background: #e9eff3;
  font-weight: bold;
}
#vcomments .vemojis{
  max-height: 200px;
}
#vcomments .vemojis i{
  width: 4rem;
  margin: 0 .2rem;
}
.post_comments {
  background-color: #fff;
  padding: 1.25rem 0;
  margin-top: 1.4rem;
}
.post_comments .line {
  padding-bottom: 0.3rem;
  border-bottom: 1px solid #eaecef;
  position: relative;
  margin-bottom: 1.2rem;
}
.post_comments .line_name {
  color: #666;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.2rem;
  padding-left: 1rem;
}
.page-edit-read {
  font-size: 14px;
  text-align: right;
  margin: 14px 0;
}
```

## valineæºç ä¿®æ”¹

* å…ˆä¿®æ”¹åˆ¤æ–­æ˜¯qqé‚®ç®±å±•ç¤ºqqå¤´åƒçš„é—®é¢˜

æºç é‡Œç›´æ¥æœç´¢**V.cdn + (0, j.default)(e.get('mail')) + V.params**è¿™ä¸€æ®µä»£ç ç›´æ¥æ›¿æ¢æˆ**qq_img**

ç„¶åå¾€ä¸Šæ»‘æ‰¾åˆ°è¿™æ®µå‡½æ•°çš„å‡½æ•°ååœ¨b = function (e, t, n){ å’Œ var r = (0, L.default) ä¸­é—´åŠ å…¥è¿™æ®µä»£ç 

```js
var qq_img=V.cdn + (0, j.default)(e.get('mail')) + V.params;//é»˜è®¤gravatorå¤´åƒæ¥å£
if(e.get('mail').indexOf("@qq.com") >= 0){
  var prefix = e.get('mail').replace(/@.*/, "");//å‰ç¼€
  var pattern=/^\d+$/g;  //æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ•°å­—
  var result= prefix.match(pattern);//match æ˜¯åŒ¹é…çš„æ„æ€
  if(result!==null){
    qq_img = "//q1.qlogo.cn/g?b=qq&nk="+ prefix +"&s=100";//è¿™æ˜¯è·å–qqå¤´åƒçš„æ¥å£
  }
}
```

å°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºqqå¤´åƒäº†

* ä½ æƒ³åˆ é™¤ä»»ä½•è¯„è®ºæ¡†ä¸­åŸæœ‰å®šä¹‰çš„æ–‡å­—ç›´æ¥å…¨å±€æœç´¢ï¼Œå¯¹åº”åˆ é™¤å³å¯ï¼Œæˆ‘åˆ é™¤äº†power by valineï¼Œ è¿˜æœ‰æ—è¾¹çš„é‚£ä¸ªmarkdownå°å›¾æ ‡mâ†“

## æ¥å…¥formspreeå‘é€é‚®ä»¶

* ç€é‡è®²ä¸€ä¸‹è¿™ä¸ªformspreeå§

[formspree](https://formspree.io/) æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹apiï¼Œå¯ä»¥å…è´¹å‘é€é‚®ä»¶ï¼Œè€Œä¸”æ”¯æŒè‡ªå®šä¹‰åŸŸåï¼Œå…ˆå»ä»–çš„å®˜ç½‘æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œé‚®ç®±å°±å¯ä»¥ç›´æ¥æ³¨å†Œï¼Œç„¶åé‚®ç®±è®¤è¯ä¸€ä¸‹å°±å¯ä»¥ç”¨äº†ï¼Œç¨³å®šå¥½ç”¨ï¼Œå¤§æ¦‚æœ‰ä¸ªå‡ åˆ†é’Ÿçš„å»¶è¿Ÿä¸è¿‡ä¸å½±å“

* æ³¨å†Œå®Œä¹‹åå»æ–°å»ºä¸€ä¸ªformï¼Œè¿™é‡Œformçš„åç§°å¯ä»¥éšä¾¿å¡«ï¼Œæˆ‘å»ºè®®ä½ å¡«ä¸€ä¸ªä½ çš„åšå®¢æœ‰ä¸€ä¸ªè¯„è®ºå¾…æŸ¥æ”¶ä¹‹ç±»çš„åç§°è¿™é‡Œçš„åç§°å°±æ˜¯æ¥æ”¶é‚®ä»¶çš„titleï¼Œæ‰€ä»¥ä¸€ç›®äº†ç„¶ä¼šå¥½ä¸€ç‚¹ï¼Œé‚®ç®±å°±å¡«ä½ å¸¸ç”¨çš„é‚®ç®±ï¼Œå¡«å†™å®Œä¹‹åä½ å°±å¾—åˆ°äº†ä¸€ä¸ªform's endpointï¼Œå°±æ˜¯ä½ çš„ä¸“å±é‚®ä»¶å‘é€æ¥å£ï¼Œcopyä¸‹æ¥ï¼Œç­‰ä¼šè¦ç”¨

<a data-fancybox="gallery" href="https://i.miji.bid/2023/12/20/5331082480aeccb894d82def10aebce0.png" data-caption="formspree">
<img v-lazy="'https://i.miji.bid/2023/12/20/5331082480aeccb894d82def10aebce0.png'"/>
</a>

é‚®ä»¶æ¥æ”¶åˆ°çš„æ•ˆæœ

<a data-fancybox="gallery" href="https://i.miji.bid/2023/12/20/113508b2e9eed1d6ccd60bac0e0e4aac.png" data-caption="æ¥æ”¶åˆ°çš„é‚®ä»¶">
<img v-lazy="'https://i.miji.bid/2023/12/20/113508b2e9eed1d6ccd60bac0e0e4aac.png'"/>
</a>

* æ¥ä¸‹æ¥å°±æ˜¯ä¿®æ”¹ä½ çš„valineçš„ä»£ç è¯„è®ºé…ç½®äº†ï¼Œåœ¨onMountedç»™valineçš„æäº¤æŒ‰é’®ä¸Šæ·»åŠ ä¸€ä¸ªclickç›‘å¬äº‹ä»¶ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š

```js
onMounted(() => {
  // åŠ è½½ Valine æ’ä»¶
  remoteImport('/js/valine.js').then(() => {
    // åˆå§‹åŒ– Valine
    initValine();
    // è·å–æäº¤æŒ‰é’®å…ƒç´ å¹¶æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬
    const submitButton = document.querySelector('.vsubmit');
    submitButton.addEventListener('click', handleButtonClick);
  });
});
// å¤„ç†æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
const handleButtonClick = async () => {
  // è·å–æ˜µç§°ã€é‚®ç®±ã€é“¾æ¥å’Œè¯„è®ºå†…å®¹çš„è¾“å…¥æ¡†å…ƒç´ 
  const nick = document.querySelector('.vnick');
  const mail = document.querySelector('.vmail');
  const link = document.querySelector('.vlink');
  const message = document.querySelector('#veditor');
  // æ­£åˆ™è¡¨è¾¾å¼éªŒè¯é‚®ç®±æ ¼å¼
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  // å¦‚æœé‚®ç®±æ ¼å¼åˆæ³•ï¼Œåˆ™ä½¿ç”¨ Axios å‘é€è¯„è®ºæ•°æ®åˆ°æŒ‡å®šæ¥å£
  if (emailRegex.test(mail.value)) {
    // æŠŠåˆšæ‰çš„é‚®ç®±å‘é€æ¥å£å¤åˆ¶åˆ°è¿™é‡Œ
    await axios.post('https://your-comment-api-endpoint', {
      Message: message.value,
      Email: mail.value,
      Name: nick.value,
      Link: link.value,
    });
  }
};
// åœ¨ç»„ä»¶å¸è½½å‰ç§»é™¤æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬
onBeforeUnmount(() => {
  const submitButton = document.querySelector('.vsubmit');
  submitButton.removeEventListener('click', handleButtonClick);
});
```

* è¿™æ ·ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æäº¤æŒ‰é’®æ—¶ï¼Œå°±ä¼šè§¦å‘ä½ åˆšæ‰æ·»åŠ çš„ç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä»è€Œå®ç°é‚®ä»¶æç¤ºåŠŸèƒ½ï¼Œè€Œä¸”ä¸ä¼šå½±å“ Valine è¯„è®ºçš„æ­£å¸¸ä½¿ç”¨ã€‚

## è¡¥å……

* åé¢æˆ‘å‘å¸ƒä¸Šå»ä¹‹åå‘ç°äº†ä¸€ç‚¹é—®é¢˜ï¼Œvalineæºç é‡Œå¼•å…¥çš„leancloudçš„cdn [leancloud-storage](https://unpkg.com/leancloud-storage@3.15.0/dist/av-min.js) ä»–å¨˜çš„æ²¡æ¢¯å­è®¿é—®ä¸åˆ°ï¼Œè¿™èƒ½éš¾å€’ä¸€ä¸ªä¸å±ˆä¸æŒ çš„ä»£ç äººå—ï¼Œæˆ‘ç›´æ¥æŠŠè¿™ä¸ªæºç downloadä¸‹æ¥æ”¾åœ¨æœ¬åœ°å¼•å…¥ï¼Œå®Œç¾è§£å†³é—®é¢˜ã€‚

## å®Œæ•´ä»£ç 

```vue
<template>
  <div class="post_comments">
    <div class="line">
      <div class="line_name">è¯„è®º</div>
    </div>
    <section class="page-edit">
      <div class="page-edit-read">
        <!-- id å°†ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ -->
        <span class="leancloud-visitors" data-flag-title="Your Article Title">
          <em class="post-meta-item-text">é˜…è¯»é‡ï¼š </em>
          <i class="leancloud-visitors-count"></i>
        </span>
      </div>
      <div id="vcomments"></div>
    </section>
  </div>
</template>

<script setup>
import { watch, onMounted, onBeforeUnmount, nextTick } from 'vue'
import { useRoute } from 'vitepress'
import axios from 'axios'
import { remoteImport } from '../../utils/functions'

const route = useRoute()
const initValine = () => {
  let path = location.origin + location.pathname
  document.getElementsByClassName('leancloud-visitors')[0].id = path
  new Valine({
    el: '#vcomments',
    appId: '',
    appKey: '',
    path: path,
    enableQQ: true,
    visitor: true,
    recordIP: true,
    requiredFields: ['mail'],
    placeholder: 'è¾“å…¥è¯„è®ºå†…å®¹ï¼Œç‚¹å‡»å¤´åƒè·³è½¬ä¼šå¡«å†™çš„åœ°å€ï¼Œè¾“å…¥é‚®ç®±æˆ‘æ‰ä¼šæ”¶åˆ°ä½ çš„è¯„è®ºé‚®ä»¶å“Ÿ',
    emojiCDN: '',
    emojiMaps: {
    }
  })
}

watch(
  () => route.path,
  () => {
    initValine()
  }
)

onMounted(() => {
  remoteImport('/js/valine.js').then(() => {
    initValine()
    const submitButton = document.querySelector('.vsubmit');
    submitButton.addEventListener('click', handleButtonClick);
  })
})

const handleButtonClick = async() => {
  const nick = document.querySelector('.vnick');
  const mail = document.querySelector('.vmail');
  const link = document.querySelector('.vlink');
  const message = document.querySelector('#veditor');
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  if (emailRegex.test(mail.value)) {
    await axios.post('', {Message: message.value, Email: mail.value, Name: nick.value, Link: link.value})
  }
}

onBeforeUnmount(() => {
  const submitButton = document.querySelector('.vsubmit');
  submitButton.removeEventListener('click', handleButtonClick);
})
</script>

<style lang="scss">
#veditor {
  background-image: url(https://pic.imgdb.cn/item/655dd56fc458853aef7b4274.webp);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: right;
  background-color: rgba(255, 255, 255, 0);
  resize: vertical;
}
#vcomments .vheader .vnick {
  width: 29%;
  border: 2px solid #dedede;
  padding-left: 10px;
  padding-right: 10px;
  border-radius: 5px;
}
#vcomments .vheader .vmail {
  width: 29%;
  border: 2px solid #dedede;
  margin-left: 15px;
  padding-left: 10px;
  padding-right: 10px;
  border-radius: 5px;
}
#vcomments .vpanel .vwrap{
  border: 2px solid #f0f0f0;
}
#vcomments .vheader .vlink {
  width: 29%;
  border: 2px solid #dedede;
  margin-left: 15px;
  padding-left: 10px;
  padding-right: 10px;
  border-radius: 5px;
}
img.vimg {
  transition: all 1s; /* æ—‹è½¬æ—¶é—´ä¸º 1s */
}
img.vimg:hover {
  transform: rotate(360deg);
  -webkit-transform: rotate(360deg);
  -moz-transform: rotate(360deg);
  -o-transform: rotate(360deg);
  -ms-transform: rotate(360deg);
}
#vcomments .vcards .vcard {
  margin: 0 2px;
  padding: 15px 20px 0 20px;
  border-radius: 10px;
  margin-bottom: 15px;
  box-shadow: 0 0 3px 1px rgba(0, 0, 0, 0.12);
  transition: all 0.3s;
}
#vcomments .vcards .vcard:hover {
  box-shadow: 0 0 6px 2px rgba(0, 0, 0, 0.12);
}
#vcomments .vcards .vcard .vh .vcard {
  border: none;
  box-shadow: none;
}
#vcomments .vcards .vcard .vh .vhead .vsys{
  background: #828282;
  padding: 0 0.2rem;
  color: #fff;
  font-size: 12px;
  line-height: 20px;
}
#vcomments .vrow .vsubmit{
  color: #555;
  padding: 0.5em 2.3em;
  margin: 0 0.5em;
  min-width: 60px;
  max-width: 100%;
  background: #e9eff3;
  font-weight: bold;
}
#vcomments .vemojis{
  max-height: 200px;
}
#vcomments .vemojis i{
  width: 4rem;
  margin: 0 .2rem;
}
.post_comments {
  background-color: #fff;
  padding: 1.25rem 0;
  margin-top: 1.4rem;
}
.post_comments .line {
  padding-bottom: 0.3rem;
  border-bottom: 1px solid #eaecef;
  position: relative;
  margin-bottom: 1.2rem;
}
.post_comments .line_name {
  color: #666;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.2rem;
  padding-left: 1rem;
}
.page-edit-read {
  font-size: 14px;
  text-align: right;
  margin: 14px 0;
}
</style>
```

ç»ˆäºä¸ç”¨çº ç»“å†è¯„è®ºçš„é—®é¢˜äº†ï¼

<Fancybox />
<Comment />